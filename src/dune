; (executable
;   (name fpse_project)
;   (libraries core core_unix torch torch.vision postgresql dream cohttp-lwt-unix lwt)
;   (modes native)
;   (modules_without_implementation embedding image)
;   (modules (:standard \ database neural_style_transfer server)))

(library
  (name image)
  (modules image)
  (modules_without_implementation image)
  (libraries embedding))

(library
  (name embedding)
  (modules embedding))

(library
  (name database)
  (modules database)
  (modules_without_implementation database)
  (libraries core core_unix postgresql image embedding))

(library
  (name neural_style_transfer)
  (modules neural_style_transfer)
  (modules_without_implementation neural_style_transfer)
  (libraries core core_unix torch torch.vision))

(library
  (name server)
  (modules server)
  (modules_without_implementation server)
  (libraries core core_unix dream cohttp-lwt-unix lwt))

(executable
  (name testing_embeddings)
  (modules testing_embeddings)
  (libraries
  core 
  core_unix.filename_unix
  core_unix.command_unix
  cohttp-lwt-unix 
  cohttp
  lwt
  yojson)
  (preprocess (pps ppx_let bisect_ppx)))

  (executable
  (name style_dataset_utils)
  (modules style_dataset_utils)
  (libraries
  core 
  core_unix.filename_unix
  core_unix.command_unix
  cohttp-lwt-unix 
  cohttp
  lwt
  yojson
  csv
  embedding)
  (preprocess (pps ppx_let bisect_ppx)))